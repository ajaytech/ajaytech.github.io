---
id: deploycapmscp
title: Deploy App to SCF
---


## Step 1: Building DB Artifacts

  

Till now, we were using sqlite3 Database in the local environment to test. Now we will use HANA® DB in Cloud or HDI Container(which comes with Free Trial of SCF).

  

To deploy our database artifacts i.e the `cds` which describe the structure and `csv` data. We need to first convert it to SQL, in which the HDI container/HANA® DB can process the creation of the table and loading of data.

  

For this we need to build our db artifacts, this we do by opening .cdsrc.json and adding the content as shown below

  

```javascript

{

"build": {

"target": "gen",

"tasks": [

{ "src": "db", "for": "hana", "options": { "model": ["db", "srv"] } },

{ "src": "srv", "for": "node-cf", "options": { "model": ["db", "srv"] } },

{ "src": "app", "for": "node-cf" }

]

}

}

```

  

***Note***: In this case, we are telling the CAPM to create a build inside folder `gen`(which will get created once we run `cds build/all` command). And inside the gen folder, we will get db, srv and app build code.

  

For our purpose, we only need db artifacts so the above .cdsrc.json code can be just for db build as shown below

  

```javascript

{

"build": {

"target": "gen",

"tasks": [

{ "src": "db", "for": "hana", "options": { "model": ["db", "srv"] } }

]

}

}

```

  

## Step 2: cds build/all to Build Artifacts

  

Now let's start the build process which will read the .cdsrc.json file and create a gen folder and add all the build artifacts inside it

  

```sh

cds build/all

```

  

## Step 3: Create the HDI Container in SCF

  

Now lets, create the HDI container in the cloud. We can do it manually with Cockpit UI or with CLI. Below us CLI Code which you can execute after you are logged in to your SCF account from CLI

  

```sh

cf create-service hanatrial hdi-shared somedbname

```

In this case, the SAP® Cloud Foundry service is `hanatrail`, the plan is `hdi-shared` and `somedbname` is your HDI container name.

  

## Step 4: Change package.json DB

  

Open the package.json file from the project directory and update the place we have `sqlite` to `hana` i.e. from `"kind": "sqlite",` to `"kind": "hana",`.

Here, we are telling CAPM App to use HANA® DB(or HDI) connection setting

  

```javascript

{

"name": "democds",

"version": "1.0.0",

"description": "Generated by cds init",

"repository": "<Add your repository here>",

"license": "ISC",

"dependencies": {

"@sap/cds": "^3.18.4",

"express": "^4.17.1",

"hdb": "^0.17.1",

"sqlite3": "^4.1.0"

},

"engines": {

"node": "^8.9"

},

"scripts": {

"start": "cds run"

},

"cds": {

"requires": {

"db": {

"kind": "hana",

"model": [

"db/",

"srv/"

]

}

}

}

}

```

***Note***: You can also run command to uninstall sqlite3 from the project if you face `exit status 14` error while deploying the app to SCF with below command

```sh
npm uninstall sqlite3
```
or Just remove the `sqlite3` `dependencies` from `package.json`.
  

## Step 5: Create YML

  

To deploy our App in cloud we can either use mta.yml or manifest.yml.

  

***Note:*** .yml and .yaml are both extensions of YML descriptor file and are same. But `mta.yml` and `manifest.yml` are both different kinds.

You can think `mta.yml` as an advanced version of `manifest.yml` where you have more features like adding resource bundles, also when an app is deployed with `mta.yml` file then in client-side a compressed zip file is created with all Apps artifacts and then this zip file is deployed to Cloud. In the case of using `manifest.yml` file while deploying, all files are uploaded sequentially and no zip file is created locally as in the previous case.

  

In our case, we use `manifest.yml` file in the root of the project for simplicity as shown below

  

Create a new file named manifest.yml

  

```sh

touch manifest.yml

```

  

Add Deployment information to manifest.yml file as below:

  

```yaml

---

applications:

- name: hdbApp

path: ./gen/db

memory: 256M

health-check-type: process

services:

- somedbname

  

- name: newApp

path: ./

services:

- somedbname

```

  

Here, we are first deploying the db artifacts which will create the tables in HDI container(or HANA® DB) and Add data. After that, we deploy the `newApp`, which will deploy our CAPM App.

  

## Step 6: cf push and Test

  

For deploying App in Cloud you can use the command

  

```sh

cf push

```

  

Which needs to be done in the root of the Project, where you see your `manifest.yml` file you created.

  

Output of the application will be

  

Fiori Launchpad:

  

![Output Fiori Launchpad](https://i.ibb.co/3pD91N2/Screenshot-10.png)

  

Data of Studets:

  

![Output Fiori Launchpad](https://i.ibb.co/tZztQNv/Screenshot-12.png)